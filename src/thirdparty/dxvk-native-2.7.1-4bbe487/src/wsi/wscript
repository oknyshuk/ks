#! /usr/bin/env python


def options(opt):
    return


def configure(conf):
    conf.define("DXVK_NATIVE", True)
    conf.define("DXVK_WSI_SDL3", True)
    conf.define("DXVK_PLATFORM_LINUX", True)


def build(bld):
    if bld.env.DEST_OS == "win32":
        return

    libs = []

    includes = [
        "../../include",
        "../../include/native",
        "../../include/native/windows",
        "../../include/vulkan/include",
        "../../include/spirv/include",
    ]

    source = [
        "wsi_platform.cpp",
        "sdl3/wsi_monitor_sdl3.cpp",
        "sdl3/wsi_platform_sdl3.cpp",
        "sdl3/wsi_window_sdl3.cpp",
    ]

    bld.stlib(
        source=source,
        target="wsi",
        features="cxx",
        includes=includes,
        use=libs,
        subsystem=bld.env.MSVC_SUBSYSTEM,
        idx=bld.get_taskgen_count(),
    )
